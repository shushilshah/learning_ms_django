<!-- Include Bootstrap CSS & optional Animate.css -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<style>
  /* Notification card hover */
  .notification-card {
    transition: transform 0.3s, box-shadow 0.3s;
    cursor: pointer;
  }
  .notification-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
  }

  /* Unread vs read styling */
  .unread {
    font-weight: 600;
    border-left: 5px solid #0d6efd; /* Blue accent for unread */
    background-color: #e7f1ff; /* subtle background for unread */
  }
  .read {
    font-weight: normal;
    border-left: 5px solid #6c757d; /* Grey accent for read */
    background-color: #f8f9fa;
  }

  /* Fade-in on scroll */
  .fade-in {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.6s ease-out;
  }
  .fade-in.visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<div class="container my-5">
  <h2 class="mb-4">Your Notifications</h2>
  <div class="row row-cols-1 row-cols-md-2 g-4">
    {% for n in notifications %}
      <div class="col fade-in">
        <div class="card notification-card {% if not n.is_read %}unread{% else %}read{% endif %} h-100 shadow-sm">
          <div class="card-body">
            <h5 class="card-title">
              {% if not n.is_read %}
                <span class="badge bg-primary me-2">New</span>
              {% endif %}
              {{ n.title }}
            </h5>
            <p class="card-text">{{ n.message }}</p>
          </div>
          <div class="card-footer d-flex justify-content-between align-items-center">
            <small class="text-muted">{{ n.created_at|date:"M d, Y H:i" }}</small>
            {% if not n.is_read %}
              <a href="{% url 'mark_notification_read' n.id %}" class="btn btn-sm btn-outline-primary">Mark as read</a>
            {% endif %}
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col">
        <div class="alert alert-info animate__animated animate__fadeIn" role="alert">
          No notifications yet!
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<script>
  // Fade-in on scroll
  const faders = document.querySelectorAll('.fade-in');

  const appearOptions = {
    threshold: 0.2,
    rootMargin: "0px 0px -50px 0px"
  };

  const appearOnScroll = new IntersectionObserver(function(entries, appearOnScroll) {
    entries.forEach(entry => {
      if (!entry.isIntersecting) return;
      entry.target.classList.add('visible');
      appearOnScroll.unobserve(entry.target);
    });
  }, appearOptions);

  faders.forEach(fader => {
    appearOnScroll.observe(fader);
  });
</script>
